<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kallakriti - Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background: #f5f5f5;
    color: #333;
}

/* Header */
.admin-header {
    background: linear-gradient(135deg, #1f2a44, #2f4670);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.admin-header h1 {
    font-size: 24px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.admin-info {
    display: flex;
    align-items: center;
    gap: 20px;
}

.logout-btn {
    background: #e74c3c;
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 500;
    transition: background 0.3s;
}

.logout-btn:hover {
    background: #c0392b;
}

/* Dashboard Container */
.dashboard-container {
    display: flex;
    min-height: calc(100vh - 80px);
}

/* Sidebar */
.sidebar {
    width: 250px;
    background: white;
    box-shadow: 2px 0 10px rgba(0,0,0,0.05);
    padding: 20px 0;
}

.sidebar-menu {
    list-style: none;
}

.sidebar-menu li {
    padding: 15px 25px;
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 500;
}

.sidebar-menu li:hover {
    background: #f8f4eb;
}

.sidebar-menu li.active {
    background: #9c7c38;
    color: white;
}

/* Main Content */
.main-content {
    flex: 1;
    padding: 30px;
    overflow-y: auto;
}

.section {
    background: white;
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    display: none;
}

.section.active {
    display: block;
}

.section h2 {
    color: #1f2a44;
    margin-bottom: 25px;
    padding-bottom: 10px;
    border-bottom: 2px solid #f0f0f0;
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Stats Cards */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    text-align: center;
    transition: transform 0.3s;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card i {
    font-size: 40px;
    margin-bottom: 15px;
}

.stat-card.products { border-top: 4px solid #3498db; }
.stat-card.products i { color: #3498db; }

.stat-card.complaints { border-top: 4px solid #e74c3c; }
.stat-card.complaints i { color: #e74c3c; }

.stat-card.orders { border-top: 4px solid #2ecc71; }
.stat-card.orders i { color: #2ecc71; }

.stat-card.revenue { border-top: 4px solid #9c7c38; }
.stat-card.revenue i { color: #9c7c38; }

.stat-number {
    font-size: 32px;
    font-weight: 600;
    margin: 10px 0;
}

.stat-label {
    color: #666;
    font-size: 14px;
}

/* Product Management */
.product-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
    background: #f9f9f9;
    padding: 25px;
    border-radius: 10px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #333;
}

.form-group input,
.form-group select {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    font-family: 'Poppins', sans-serif;
    transition: border-color 0.3s;
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: #9c7c38;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-buttons {
    grid-column: 1 / -1;
    display: flex;
    gap: 15px;
}

.btn {
    padding: 12px 30px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background: #9c7c38;
    color: white;
}

.btn-primary:hover {
    background: #7a612d;
}

.btn-secondary {
    background: #3498db;
    color: white;
}

.btn-secondary:hover {
    background: #2980b9;
}

.btn-danger {
    background: #e74c3c;
    color: white;
}

.btn-danger:hover {
    background: #c0392b;
}

/* Products Table */
.products-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.products-table th {
    background: #f8f4eb;
    padding: 15px;
    text-align: left;
    font-weight: 600;
    color: #1f2a44;
    border-bottom: 2px solid #e0d6c2;
}

.products-table td {
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.products-table tr:hover {
    background: #f9f9f9;
}

.product-image {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 6px;
}

.action-buttons {
    display: flex;
    gap: 10px;
}

.action-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
}

.edit-btn {
    background: #3498db;
    color: white;
}

.delete-btn {
    background: #e74c3c;
    color: white;
}

/* Complaints Table */
.complaints-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.complaints-table th {
    background: #f8f4eb;
    padding: 15px;
    text-align: left;
    font-weight: 600;
    color: #1f2a44;
    border-bottom: 2px solid #e0d6c2;
}

.complaints-table td {
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.status-badge {
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
}

.status-pending {
    background: #fff3cd;
    color: #856404;
}

.status-resolved {
    background: #d4edda;
    color: #155724;
}

/* Image Upload */
.image-preview {
    width: 150px;
    height: 150px;
    border: 2px dashed #ddd;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    overflow: hidden;
}

.image-preview img {
    max-width: 100%;
    max-height: 100%;
    display: none;
}

.image-preview span {
    color: #999;
    font-size: 14px;
}

.image-upload-btn {
    display: inline-block;
    padding: 10px 20px;
    background: #3498db;
    color: white;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
}

.image-upload-btn:hover {
    background: #2980b9;
}

/* Responsive */
@media (max-width: 1024px) {
    .dashboard-container {
        flex-direction: column;
    }
    
    .sidebar {
        width: 100%;
        order: 2;
    }
    
    .sidebar-menu {
        display: flex;
        overflow-x: auto;
    }
    
    .sidebar-menu li {
        white-space: nowrap;
    }
}

@media (max-width: 768px) {
    .product-form {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .admin-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
}

/* Alert Messages */
.alert {
    padding: 15px;
    border-radius: 6px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.alert-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

/* Quick Actions */
.quick-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 30px 0;
}

.action-card {
    background: white;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    cursor: pointer;
    transition: all 0.3s;
}

.action-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
}

.action-card i {
    font-size: 30px;
    margin-bottom: 10px;
    color: #9c7c38;
}
</style>
</head>
<body>
    <!-- Header -->
    <div class="admin-header">
        <h1><i class="fas fa-crown"></i> Kallakriti Admin Dashboard</h1>
        <div class="admin-info">
            <span><i class="fas fa-user-circle"></i> Admin</span>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li class="active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </li>
                <li onclick="showSection('products')">
                    <i class="fas fa-box"></i> Product Management
                </li>
                <li onclick="showSection('addProduct')">
                    <i class="fas fa-plus-circle"></i> Add New Product
                </li>
                <li onclick="showSection('complaints')">
                    <i class="fas fa-exclamation-triangle"></i> Customer Complaints
                </li>
                <li onclick="showSection('settings')">
                    <i class="fas fa-cog"></i> Settings
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard Overview</h2>
                
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card products">
                        <i class="fas fa-box"></i>
                        <div class="stat-number" id="totalProducts">0</div>
                        <div class="stat-label">Total Products</div>
                    </div>
                    
                    <div class="stat-card complaints">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div class="stat-number" id="totalComplaints">0</div>
                        <div class="stat-label">Pending Complaints</div>
                    </div>
                    
                    <div class="stat-card orders">
                        <i class="fas fa-shopping-cart"></i>
                        <div class="stat-number" id="totalOrders">0</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    
                    <div class="stat-card revenue">
                        <i class="fas fa-rupee-sign"></i>
                        <div class="stat-number">â‚¹<span id="totalRevenue">0</span></div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                <div class="quick-actions">
                    <div class="action-card" onclick="showSection('addProduct')">
                        <i class="fas fa-plus"></i>
                        <div>Add Product</div>
                    </div>
                    <div class="action-card" onclick="showSection('products')">
                        <i class="fas fa-edit"></i>
                        <div>Edit Products</div>
                    </div>
                    <div class="action-card" onclick="showSection('complaints')">
                        <i class="fas fa-comments"></i>
                        <div>View Complaints</div>
                    </div>
                    <div class="action-card" onclick="exportData()">
                        <i class="fas fa-download"></i>
                        <div>Export Data</div>
                    </div>
                </div>
            </div>

            <!-- Product Management Section -->
            <div id="products" class="section">
                <h2><i class="fas fa-box"></i> Product Management</h2>
                <p>Edit or delete existing products. Click "Edit" to modify product details.</p>
                
                <div class="products-table-container">
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody">
                            <!-- Products will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Add Product Section -->
            <div id="addProduct" class="section">
                <h2><i class="fas fa-plus-circle"></i> Add New Product</h2>
                
                <form id="addProductForm" class="product-form" onsubmit="addNewProduct(event)">
                    <div class="form-group">
                        <label for="productName">Product Name *</label>
                        <input type="text" id="productName" required placeholder="e.g., Crochet Rose Bouquet">
                    </div>
                    
                    <div class="form-group">
                        <label for="productPrice">Price (â‚¹) *</label>
                        <input type="number" id="productPrice" required placeholder="e.g., 299" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="productCategory">Category *</label>
                        <select id="productCategory" required>
                            <option value="">Select Category</option>
                            <option value="flowers">Crochet Flowers</option>
                            <option value="toys">Crochet Toys</option>
                            <option value="accessories">Accessories</option>
                            <option value="baby">Baby Items</option>
                            <option value="custom">Custom Orders</option>
                            <option value="money">Money Bouquets</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="productImageUrl">Image URL</label>
                        <input type="url" id="productImageUrl" placeholder="https://example.com/image.jpg">
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Image Preview</label>
                        <div class="image-preview" id="imagePreview">
                            <span>Preview will appear here</span>
                            <img id="previewImage" src="" alt="Preview">
                        </div>
                        <small>You can use free image hosting services like ImgBB or Unsplash for images</small>
                    </div>
                    
                    <div class="form-buttons">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Add Product
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="clearForm()">
                            <i class="fas fa-redo"></i> Clear Form
                        </button>
                    </div>
                </form>
            </div>

            <!-- Complaints Section -->
            <div id="complaints" class="section">
                <h2><i class="fas fa-exclamation-triangle"></i> Customer Complaints</h2>
                
                <div class="complaints-table-container">
                    <table class="complaints-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Type</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="complaintsTableBody">
                            <!-- Complaints will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                
                <div class="product-form">
                    <div class="form-group">
                        <label for="whatsappNumber">WhatsApp Number *</label>
                        <input type="tel" id="whatsappNumber" value="7002341920" required>
                        <small>When you change this, customer website will update automatically</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="adminEmail">Admin Email *</label>
                        <input type="email" id="adminEmail" value="kallakriti.craft@gmail.com" required>
                        <small>This email will show on customer website footer</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="changePassword">Change Admin Password</label>
                        <input type="password" id="changePassword" placeholder="Enter new password">
                    </div>
                    
                    <div class="form-buttons">
                        <button class="btn btn-primary" onclick="saveSettings()">
                            <i class="fas fa-save"></i> Save Settings
                        </button>
                        <button class="btn btn-secondary" onclick="resetSettings()">
                            <i class="fas fa-redo"></i> Reset to Default
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Check if admin is logged in
    if (localStorage.getItem('adminLoggedIn') !== 'true') {
        window.location.href = "admin-login.html";
    }
    
    // Check session timeout (8 hours)
    const loginTime = localStorage.getItem('loginTime');
    const currentTime = Date.now();
    const eightHours = 8 * 60 * 60 * 1000;
    
    if (currentTime - loginTime > eightHours) {
        logout();
    }

    // Product data structure (REMOVED description field)
    let products = JSON.parse(localStorage.getItem('kallakritiProducts') || '[]');
    let complaints = JSON.parse(localStorage.getItem('kallakritiComplaints') || '[]');
    let orders = JSON.parse(localStorage.getItem('kallakritiOrders') || '[]');

    // Update dashboard stats
    function updateDashboardStats() {
        document.getElementById('totalProducts').textContent = products.length;
        document.getElementById('totalComplaints').textContent = complaints.length;
        document.getElementById('totalOrders').textContent = orders.length;
        
        // Calculate total revenue
        let totalRevenue = 0;
        orders.forEach(order => {
            if (order.price && typeof order.price === 'number') {
                totalRevenue += order.price;
            }
        });
        document.getElementById('totalRevenue').textContent = totalRevenue;
    }

    // Show section
    function showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        
        // Remove active class from all menu items
        document.querySelectorAll('.sidebar-menu li').forEach(item => {
            item.classList.remove('active');
        });
        
        // Show selected section
        document.getElementById(sectionId).classList.add('active');
        
        // Add active class to clicked menu item
        const menuItems = document.querySelectorAll('.sidebar-menu li');
        menuItems.forEach((item, index) => {
            const sections = ['dashboard', 'products', 'addProduct', 'complaints', 'settings'];
            if (sections[index] === sectionId) {
                item.classList.add('active');
            }
        });
        
        // Load data for the section
        if (sectionId === 'products') {
            loadProductsTable();
        } else if (sectionId === 'complaints') {
            loadComplaintsTable();
        } else if (sectionId === 'settings') {
            loadSettingsForm();
        }
        
        updateDashboardStats();
    }

    // Load products table
    function loadProductsTable() {
        const tableBody = document.getElementById('productsTableBody');
        tableBody.innerHTML = '';
        
        products.forEach((product, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><img src="${product.img}" alt="${product.name}" class="product-image" onerror="this.src='https://via.placeholder.com/60x60/ffffff/9c7c38?text=Product'"></td>
                <td>${product.name}</td>
                <td>${getCategoryName(product.cat)}</td>
                <td>â‚¹${product.price}</td>
                <td>
                    <div class="action-buttons">
                        <button class="action-btn edit-btn" onclick="editProduct(${index})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteProduct(${index})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Get category name
    function getCategoryName(categoryCode) {
        const categories = {
            'flowers': 'Crochet Flowers',
            'toys': 'Crochet Toys',
            'accessories': 'Accessories',
            'baby': 'Baby Items',
            'custom': 'Custom Orders',
            'money': 'Money Bouquets'
        };
        return categories[categoryCode] || categoryCode;
    }

    // Load complaints table
    function loadComplaintsTable() {
        const tableBody = document.getElementById('complaintsTableBody');
        tableBody.innerHTML = '';
        
        complaints.forEach((complaint, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${complaint.id}</td>
                <td>${complaint.name}</td>
                <td>${complaint.phone}</td>
                <td>${complaint.type}</td>
                <td>${complaint.date}</td>
                <td>
                    <span class="status-badge status-pending">Pending</span>
                </td>
                <td>
                    <button class="action-btn edit-btn" onclick="viewComplaint(${index})">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteComplaint(${index})">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Load settings form
    function loadSettingsForm() {
        const settings = JSON.parse(localStorage.getItem('kallakritiSettings') || '{}');
        document.getElementById('whatsappNumber').value = settings.whatsappNumber || "7002341920";
        document.getElementById('adminEmail').value = settings.adminEmail || "kallakriti.craft@gmail.com";
    }

    // Add new product (REMOVED description field)
    function addNewProduct(event) {
        event.preventDefault();
        
        const newProduct = {
            name: document.getElementById('productName').value,
            price: parseInt(document.getElementById('productPrice').value),
            cat: document.getElementById('productCategory').value,
            img: document.getElementById('productImageUrl').value || 'https://via.placeholder.com/300x300/ffffff/9c7c38?text=Kallakriti+Product'
        };
        
        products.push(newProduct);
        localStorage.setItem('kallakritiProducts', JSON.stringify(products));
        
        // Show success message
        alert('Product added successfully!');
        
        // Clear form
        clearForm();
        
        // Update customer website
        updateCustomerWebsite();
        
        // Update dashboard
        updateDashboardStats();
        
        // Reload products table
        loadProductsTable();
    }

    // Edit product (REMOVED description field)
    function editProduct(index) {
        const product = products[index];
        
        // Fill form with product data
        document.getElementById('productName').value = product.name;
        document.getElementById('productPrice').value = product.price;
        document.getElementById('productCategory').value = product.cat;
        document.getElementById('productImageUrl').value = product.img;
        updateImagePreview();
        
        // Change form to edit mode
        const form = document.getElementById('addProductForm');
        form.onsubmit = function(e) {
            e.preventDefault();
            saveProductEdit(index);
        };
        
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Product';
        
        // Show edit section
        showSection('addProduct');
    }

    // Save product edit (REMOVED description field)
    function saveProductEdit(index) {
        products[index] = {
            name: document.getElementById('productName').value,
            price: parseInt(document.getElementById('productPrice').value),
            cat: document.getElementById('productCategory').value,
            img: document.getElementById('productImageUrl').value || 'https://via.placeholder.com/300x300/ffffff/9c7c38?text=Kallakriti+Product'
        };
        
        localStorage.setItem('kallakritiProducts', JSON.stringify(products));
        
        alert('Product updated successfully!');
        clearForm();
        showSection('products');
        loadProductsTable();
        
        // Update customer website
        updateCustomerWebsite();
    }

    // Delete product
    function deleteProduct(index) {
        if (confirm('Are you sure you want to delete this product?')) {
            products.splice(index, 1);
            localStorage.setItem('kallakritiProducts', JSON.stringify(products));
            loadProductsTable();
            updateDashboardStats();
            
            // Update customer website
            updateCustomerWebsite();
        }
    }

    // View complaint details
    function viewComplaint(index) {
        const complaint = complaints[index];
        const details = `
            Complaint ID: ${complaint.id}
            Name: ${complaint.name}
            Email: ${complaint.email}
            Phone: ${complaint.phone}
            Type: ${complaint.type}
            Date: ${complaint.date}
            
            Details:
            ${complaint.details}
        `;
        alert(details);
    }

    // Delete complaint
    function deleteComplaint(index) {
        if (confirm('Are you sure you want to delete this complaint?')) {
            complaints.splice(index, 1);
            localStorage.setItem('kallakritiComplaints', JSON.stringify(complaints));
            loadComplaintsTable();
            updateDashboardStats();
        }
    }

    // Clear form
    function clearForm() {
        document.getElementById('addProductForm').reset();
        document.getElementById('previewImage').style.display = 'none';
        document.querySelector('#imagePreview span').style.display = 'block';
        
        // Reset form to add mode
        const form = document.getElementById('addProductForm');
        form.onsubmit = function(e) {
            e.preventDefault();
            addNewProduct(e);
        };
        
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-save"></i> Add Product';
    }

    // Update image preview
    document.getElementById('productImageUrl').addEventListener('input', updateImagePreview);
    
    function updateImagePreview() {
        const url = document.getElementById('productImageUrl').value;
        const preview = document.getElementById('previewImage');
        const placeholder = document.querySelector('#imagePreview span');
        
        if (url) {
            preview.src = url;
            preview.style.display = 'block';
            placeholder.style.display = 'none';
        } else {
            preview.style.display = 'none';
            placeholder.style.display = 'block';
        }
    }

    // Update customer website
    function updateCustomerWebsite() {
        // Save products to localStorage (customer website reads from here)
        localStorage.setItem('kallakritiProducts', JSON.stringify(products));
        
        console.log('âœ… Customer website updated with new products!');
        alert('âœ… Changes saved! Customer website has been updated.');
    }

    // Save settings (NOW CONNECTED TO CUSTOMER WEBSITE)
    function saveSettings() {
        const whatsappNumber = document.getElementById('whatsappNumber').value;
        const adminEmail = document.getElementById('adminEmail').value;
        const newPassword = document.getElementById('changePassword').value;
        
        if (!whatsappNumber || !adminEmail) {
            alert('âŒ WhatsApp Number and Email are required!');
            return;
        }
        
        // Save settings to localStorage
        const settings = {
            whatsappNumber: whatsappNumber,
            adminEmail: adminEmail,
            lastUpdated: new Date().toISOString()
        };
        localStorage.setItem('kallakritiSettings', JSON.stringify(settings));
        
        // Update password if provided
        if (newPassword) {
            // In a real app, you would hash this password
            localStorage.setItem('adminPassword', newPassword);
            document.getElementById('changePassword').value = '';
        }
        
        alert('âœ… Settings saved successfully!\n\nCustomer website will update automatically with:\nðŸ“± WhatsApp: ' + whatsappNumber + '\nðŸ“§ Email: ' + adminEmail);
    }

    // Reset settings to default
    function resetSettings() {
        if (confirm('Reset to default settings?')) {
            const defaultSettings = {
                whatsappNumber: "7002341920",
                adminEmail: "kallakriti.craft@gmail.com"
            };
            localStorage.setItem('kallakritiSettings', JSON.stringify(defaultSettings));
            loadSettingsForm();
            alert('âœ… Settings reset to default!');
        }
    }

    // Export data
    function exportData() {
        const data = {
            products: products,
            complaints: complaints,
            orders: orders,
            settings: JSON.parse(localStorage.getItem('kallakritiSettings') || '{}'),
            exportDate: new Date().toISOString()
        };
        
        const dataStr = JSON.stringify(data, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = `kallakriti-data-${Date.now()}.json`;
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
    }

    // Logout
    function logout() {
        localStorage.removeItem('adminLoggedIn');
        localStorage.removeItem('loginTime');
        window.location.href = "admin-login.html";
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', function() {
        updateDashboardStats();
        loadProductsTable();
        loadComplaintsTable();
        loadSettingsForm();
        
        // Auto logout after 8 hours
        setInterval(() => {
            const loginTime = localStorage.getItem('loginTime');
            const currentTime = Date.now();
            if (currentTime - loginTime > eightHours) {
                logout();
            }
        }, 60000); // Check every minute
    });
    </script>
</body>
</html>
