<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kallakriti – Crochet & Craft</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Poppins:wght@300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:#f4efe8;
  color:#1f2a44;
}

/* HEADER */
header{
  background:linear-gradient(135deg,#1f2a44,#2f4670);
  color:#f5e6c8;
  padding:15px;
  position:relative;
}
.header-content{
  display:flex;
  align-items:center;
  justify-content:space-between;
  max-width:1200px;
  margin:0 auto;
}
.header-left{
  display:flex;
  align-items:center;
  gap:15px;
}
header img{
  width:60px;
  height:60px;
  object-fit:contain;
  border-radius:8px;
}
.header-text h1{
  margin:0;
  font-family:'Playfair Display',serif;
  letter-spacing:1px;
  font-size:1.4rem;
}
.header-text p{
  font-size:0.75rem;
  margin:3px 0 0 0;
  opacity:0.9;
}

/* USER PROFILE */
.user-profile {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-left: 20px;
}

.user-btn {
  background: #9c7c38;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 18px;
  cursor: pointer;
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: 'Poppins', sans-serif;
  transition: all 0.3s ease;
}

.user-btn:hover {
  background: #7a612d;
  transform: scale(1.05);
}

.user-name {
  color: #f5e6c8;
  font-size: 0.9rem;
  font-weight: 500;
}

/* CART ICON */
.cart-icon {
  position: relative;
  margin-left: 10px;
}

.cart-btn {
  background: #e74c3c;
  color: white;
  border: none;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  position: relative;
  transition: all 0.3s ease;
}

.cart-btn:hover {
  background: #c0392b;
  transform: scale(1.1);
}

.cart-count {
  position: absolute;
  top: -5px;
  right: -5px;
  background: #ffeb3b;
  color: #333;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
}

/* CATEGORY SELECTOR */
.category-selector{
  position:relative;
  z-index:1000;
}
.category-btn{
  background:#9c7c38;
  color:white;
  border:none;
  padding:8px 16px;
  border-radius:18px;
  cursor:pointer;
  font-size:0.9rem;
  display:flex;
  align-items:center;
  gap:6px;
  font-family:'Poppins',sans-serif;
  transition:all 0.3s ease;
}
.category-btn:hover{
  background:#7a612d;
  transform:scale(1.05);
}
.category-dropdown{
  position:absolute;
  top:100%;
  left:0;
  background:white;
  border-radius:8px;
  box-shadow:0 5px 15px rgba(0,0,0,0.15);
  padding:0;
  min-width:180px;
  display:none;
  z-index:1001;
  margin-top:5px;
  overflow:hidden;
  border:1px solid #eee;
}
.category-dropdown.show{
  display:block;
}
.category-dropdown button{
  display:block;
  width:100%;
  padding:10px 16px;
  text-align:left;
  background:none;
  border:none;
  border-bottom:1px solid #f0f0f0;
  cursor:pointer;
  color:#1f2a44;
  font-family:'Poppins',sans-serif;
  font-size:0.9rem;
  transition:all 0.2s ease;
}
.category-dropdown button:last-child{
  border-bottom:none;
}
.category-dropdown button:hover{
  background:#f8f4eb;
  padding-left:20px;
}
.category-dropdown button.active{
  background:#9c7c38;
  color:white;
  font-weight:500;
}

/* PRODUCTS - SMALLER CARDS */
.products{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(160px, 1fr));
  gap:18px;
  padding:20px;
  max-width:1200px;
  margin:0 auto;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:12px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  text-align:center;
  transition:all 0.3s ease;
  border:1px solid #f0f0f0;
  height:100%;
  display:flex;
  flex-direction:column;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 8px 20px rgba(0,0,0,.12);
  border-color:#e0d6c2;
}
.card img{
  width:100%;
  height:140px;
  object-fit:cover;
  border-radius:10px;
  margin-bottom:10px;
}
.card h3{
  margin:6px 0;
  font-size:0.95rem;
  color:#1f2a44;
  line-height:1.3;
  font-weight:600;
  flex-grow:1;
}
.price{
  font-weight:600;
  margin:8px 0;
  color:#9c7c38;
  font-size:1.1rem;
}

/* BUTTONS ORDER - Add to Cart ABOVE Order Now */
.cart-add-btn {
  background: #3498db;
  color: white;
  border: none;
  width: 100%;
  padding: 9px;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.3s ease;
  font-size: 0.85rem;
  margin-top: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.cart-add-btn:hover {
  background: #2980b9;
  transform: scale(1.03);
}

.order-btn{
  background:#9c7c38;
  color:white;
  border:none;
  width:100%;
  padding:9px;
  border-radius:20px;
  cursor:pointer;
  font-weight:500;
  transition:all 0.3s ease;
  font-size:0.85rem;
  margin-top: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}
.order-btn:hover{
  background:#7a612d;
  transform:scale(1.03);
}

/* CART MODAL */
.cart-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.cart-content {
  background: white;
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  border-radius: 15px;
  padding: 25px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
}

.cart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.cart-header h3 {
  margin: 0;
  color: #1f2a44;
  display: flex;
  align-items: center;
  gap: 10px;
}

.cart-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
}

.cart-items {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 20px;
}

.cart-item {
  display: flex;
  align-items: center;
  padding: 15px;
  border-bottom: 1px solid #eee;
}

.cart-item-img {
  width: 60px;
  height: 60px;
  border-radius: 8px;
  object-fit: cover;
  margin-right: 15px;
}

.cart-item-details {
  flex: 1;
}

.cart-item-name {
  font-weight: 600;
  margin-bottom: 5px;
}

.cart-item-price {
  color: #9c7c38;
  font-weight: 600;
}

.cart-item-controls {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 5px;
}

.quantity-btn {
  background: #f0f0f0;
  border: none;
  width: 25px;
  height: 25px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.quantity-btn:hover {
  background: #ddd;
}

.cart-item-quantity {
  font-weight: 600;
  min-width: 20px;
  text-align: center;
}

.cart-item-remove {
  background: #e74c3c;
  color: white;
  border: none;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 10px;
}

.cart-empty {
  text-align: center;
  padding: 40px;
  color: #666;
}

.cart-total {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 0;
  border-top: 2px solid #eee;
  font-size: 1.2rem;
  font-weight: 600;
}

.cart-actions {
  display: flex;
  gap: 10px;
}

.cart-checkout {
  background: #2ecc71;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: 600;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.cart-clear {
  background: #e74c3c;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

/* LOGIN MODAL */
.login-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.login-content {
  background: white;
  width: 90%;
  max-width: 400px;
  border-radius: 15px;
  padding: 30px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}

.login-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.login-header h3 {
  margin: 0;
  color: #1f2a44;
  display: flex;
  align-items: center;
  gap: 10px;
}

.login-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
}

.login-form input {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
  font-family: 'Poppins', sans-serif;
  transition: border-color 0.3s;
}

.login-form input:focus {
  outline: none;
  border-color: #9c7c38;
}

.login-submit {
  background: #9c7c38;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 500;
  width: 100%;
  margin-top: 15px;
  transition: background 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.login-submit:hover {
  background: #7a612d;
}

.login-switch {
  text-align: center;
  margin-top: 20px;
  color: #666;
  font-size: 0.9rem;
}

.login-switch a {
  color: #9c7c38;
  cursor: pointer;
  font-weight: 500;
}

/* SECTIONS */
.section{
  background:#fff;
  margin:25px auto;
  padding:25px;
  border-radius:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
  max-width:1200px;
  border:1px solid #f0f0f0;
}
.section h2{
  font-family:'Playfair Display',serif;
  text-align:center;
  color:#1f2a44;
  margin-bottom:18px;
  font-size:1.5rem;
}
.section p{
  line-height:1.6;
  color:#555;
  margin:10px 0;
}

/* COMPLAINT BUTTON */
.complaint-btn {
  position: fixed;
  bottom: 90px;
  right: 20px;
  background: #e74c3c;
  color: white;
  padding: 12px 20px;
  border-radius: 25px;
  text-decoration: none;
  font-size: 0.9rem;
  box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3);
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 50;
  transition: all 0.3s ease;
  font-weight: 600;
  border: none;
  cursor: pointer;
}

.complaint-btn:hover {
  background: #c0392b;
  transform: scale(1.08);
  box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
}

/* WHATSAPP BUTTON */
.whatsapp-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #25d366;
  color: white;
  padding: 13px 22px;
  border-radius: 25px;
  text-decoration: none;
  font-size: 0.95rem;
  box-shadow: 0 6px 15px rgba(37, 211, 102, 0.3);
  display: flex;
  align-items: center;
  gap: 10px;
  z-index: 50;
  transition: all 0.3s ease;
  font-weight: 600;
}

.whatsapp-btn:hover {
  background: #1da851;
  transform: scale(1.08);
  box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4);
}

/* COMPLAINT MODAL */
.complaint-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.complaint-content {
  background: white;
  width: 90%;
  max-width: 500px;
  border-radius: 15px;
  padding: 25px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}

.complaint-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.complaint-header h3 {
  margin: 0;
  color: #1f2a44;
  display: flex;
  align-items: center;
  gap: 10px;
}

.complaint-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
}

.complaint-form input,
.complaint-form textarea,
.complaint-form select {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-family: 'Poppins', sans-serif;
  font-size: 0.9rem;
}

.complaint-form textarea {
  height: 120px;
  resize: vertical;
}

.complaint-submit {
  background: #e74c3c;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 500;
  width: 100%;
  margin-top: 15px;
  transition: background 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.complaint-submit:hover {
  background: #c0392b;
}

/* FOOTER */
footer{
  background:#1f2a44;
  color:#f5e6c8;
  text-align:center;
  padding:30px;
  margin-top:40px;
}
footer p{
  margin:8px 0;
  font-size:0.95rem;
}
footer a{
  color:#9c7c38;
  text-decoration:none;
  font-weight:500;
}

/* RESPONSIVE */
@media (max-width:768px){
  .header-content{
    flex-direction:column;
    gap:12px;
  }
  .header-left{
    flex-direction:column;
    text-align:center;
    gap:8px;
  }
  .user-profile {
    margin-left: 0;
    margin-top: 10px;
  }
  .cart-icon {
    margin-left: 10px;
  }
  .category-selector{
    width:100%;
    display:flex;
    justify-content:center;
    margin-top: 10px;
  }
  .category-btn{
    width:auto;
  }
  .category-dropdown{
    left:50%;
    transform:translateX(-50%);
  }
  .products{
    grid-template-columns:repeat(auto-fill, minmax(140px, 1fr));
    gap:12px;
    padding:15px;
  }
  .card{
    padding:10px;
  }
  .card img{
    height:120px;
  }
  .card h3{
    font-size:0.9rem;
  }
  .section{
    margin:20px 15px;
    padding:20px;
  }
  
  .complaint-btn {
    bottom: 80px;
    right: 15px;
    padding: 11px 18px;
    font-size: 0.85rem;
  }
  
  .whatsapp-btn {
    bottom: 15px;
    right: 15px;
    padding: 12px 20px;
    font-size: 0.9rem;
  }
  
  .cart-content,
  .login-content {
    width: 95%;
    padding: 15px;
  }
}

@media (min-width:1200px){
  .products{
    grid-template-columns:repeat(6, 1fr);
  }
}

/* LOGO STYLES */
.logo-container{
  display:flex;
  align-items:center;
  gap:12px;
}
.logo-img{
  width:60px;
  height:60px;
  border-radius:10px;
  background:white;
  padding:5px;
  display:flex;
  align-items:center;
  justify-content:center;
}
</style>
</head>

<body>

<header>
  <div class="header-content">
    <div class="header-left">
      <div class="logo-container">
        <!-- LOGO -->
        <img src="https://raw.githubusercontent.com/kallakriti/kallakriti/main/images/logo.png" 
             alt="Kallakriti Logo" 
             class="logo-img"
             onerror="showFallbackLogo(this)">
        <div class="header-text">
          <h1>Kallakriti</h1>
          <p>Handmade Crochet & Craft • Custom Creations</p>
        </div>
      </div>
    </div>
    
    <div style="display: flex; align-items: center; gap: 15px;">
      <!-- CATEGORY SELECTOR -->
      <div class="category-selector">
        <button class="category-btn" onclick="toggleCategoryDropdown(event)">
          <span id="currentCategoryText">☰ All Products</span>
        </button>
        <div class="category-dropdown" id="categoryDropdown">
          <button onclick="selectCategory('all')">All Products</button>
          <button onclick="selectCategory('flowers')">Crochet Flowers</button>
          <button onclick="selectCategory('toys')">Crochet Toys</button>
          <button onclick="selectCategory('accessories')">Accessories</button>
          <button onclick="selectCategory('baby')">Baby Items</button>
          <button onclick="selectCategory('custom')">Custom Orders</button>
          <button onclick="selectCategory('money')">Money Bouquets</button>
        </div>
      </div>
      
      <!-- USER PROFILE -->
      <div class="user-profile">
        <span id="userName" class="user-name" style="display: none;"></span>
        <button class="user-btn" onclick="openLogin()">
          <i class="fas fa-user"></i> <span id="userBtnText">Login</span>
        </button>
      </div>
      
      <!-- CART ICON -->
      <div class="cart-icon">
        <button class="cart-btn" onclick="openCart()">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-count" id="cartCount">0</span>
        </button>
      </div>
    </div>
  </div>
</header>

<div id="products" class="products"></div>

<div class="section">
  <h2>About Kallakriti</h2>
  <p>
    Kallakriti is a handmade crochet & craft brand where every piece is thoughtfully
    crafted with love. From flowers and toys to baby items and money bouquets,
    we create elegant and customized products for every occasion.
  </p>
</div>

<div class="section">
  <h2>How to Order</h2>
  <p>1. Login or Sign Up to save your cart</p>
  <p>2. Browse collection and add items to cart</p>
  <p>3. Click cart icon to review your selection</p>
  <p>4. Click "Checkout" to send order via WhatsApp</p>
  <p>5. We'll craft your personalized items with care!</p>
</div>

<!-- LOGIN MODAL -->
<div class="login-modal" id="loginModal">
  <div class="login-content">
    <div class="login-header">
      <h3><i class="fas fa-user-circle"></i> <span id="loginTitle">Customer Login</span></h3>
      <button class="login-close" onclick="closeLogin()">×</button>
    </div>
    
    <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
      <div id="signupFields" style="display: none;">
        <input type="text" id="signupName" placeholder="Full Name" required>
      </div>
      
      <input type="tel" id="loginPhone" placeholder="Phone Number" required>
      <input type="password" id="loginPassword" placeholder="Password" required>
      
      <button type="submit" class="login-submit">
        <i class="fas fa-sign-in-alt"></i> <span id="loginSubmitText">Login</span>
      </button>
    </form>
    
    <div class="login-switch">
      <span id="loginSwitchText">New customer?</span>
      <a id="loginSwitchLink" onclick="toggleLoginMode()">Sign Up</a>
    </div>
  </div>
</div>

<!-- CART MODAL -->
<div class="cart-modal" id="cartModal">
  <div class="cart-content">
    <div class="cart-header">
      <h3><i class="fas fa-shopping-cart"></i> Your Cart</h3>
      <button class="cart-close" onclick="closeCart()">×</button>
    </div>
    
    <div class="cart-items" id="cartItems">
      <!-- Cart items will appear here -->
    </div>
    
    <div class="cart-total">
      <span>Total:</span>
      <span id="cartTotal">₹0</span>
    </div>
    
    <div class="cart-actions">
      <button class="cart-checkout" onclick="checkout()">
        <i class="fab fa-whatsapp"></i> Checkout on WhatsApp
      </button>
      <button class="cart-clear" onclick="clearCart()">
        <i class="fas fa-trash"></i> Clear Cart
      </button>
    </div>
  </div>
</div>

<!-- COMPLAINT MODAL -->
<div class="complaint-modal" id="complaintModal">
  <div class="complaint-content">
    <div class="complaint-header">
      <h3><i class="fas fa-exclamation-triangle"></i> Register Complaint</h3>
      <button class="complaint-close" onclick="closeComplaintModal()">×</button>
    </div>
    <form class="complaint-form" id="complaintForm" onsubmit="submitComplaint(event)">
      <input type="text" id="complaintName" placeholder="Your Name" required>
      <input type="email" id="complaintEmail" placeholder="Email Address" required>
      <input type="tel" id="complaintPhone" placeholder="Phone Number" required>
      <select id="complaintType" required>
        <option value="">Select Complaint Type</option>
        <option value="delivery">Delivery Issue</option>
        <option value="quality">Product Quality</option>
        <option value="damage">Damaged Product</option>
        <option value="service">Customer Service</option>
        <option value="other">Other</option>
      </select>
      <textarea id="complaintDetails" placeholder="Please describe your complaint in detail..." required></textarea>
      <button type="submit" class="complaint-submit">
        <i class="fas fa-paper-plane"></i> Submit Complaint
      </button>
    </form>
  </div>
</div>

<!-- FLOATING BUTTONS -->
<button class="complaint-btn" onclick="openComplaintModal()">
  <i class="fas fa-exclamation-circle"></i> Register Complaint
</button>

<a id="whatsappLink" href="#" 
   class="whatsapp-btn" target="_blank">
  <i class="fab fa-whatsapp"></i> Chat on WhatsApp
</a>

<footer>
  <p>Contact: <span id="footerPhone">+91 7002341920</span></p>
  <p>Email: <span id="footerEmail">kallakriti.craft@gmail.com</span></p>
  <p><small>Login to save your cart across devices</small></p>
</footer>

<script>
// ==================== LOAD SETTINGS FROM ADMIN ====================
const defaultSettings = {
  whatsappNumber: "7002341920",
  adminEmail: "kallakriti.craft@gmail.com"
};

let settings = JSON.parse(localStorage.getItem('kallakritiSettings') || JSON.stringify(defaultSettings));
let phone = settings.whatsappNumber || "7002341920";

// Update WhatsApp link
const whatsappLink = document.getElementById('whatsappLink');
whatsappLink.href = `https://wa.me/${phone}?text=Hello Kallakriti, I have an inquiry`;

// Update footer contact info
document.getElementById('footerPhone').textContent = `+91 ${phone}`;
document.getElementById('footerEmail').textContent = settings.adminEmail || "kallakriti.craft@gmail.com";

// ==================== LOAD PRODUCTS FROM ADMIN PANEL ====================
let items = JSON.parse(localStorage.getItem('kallakritiProducts') || '[]');

// If no products in localStorage, use these default ones
if (items.length === 0) {
    items = [
        {id: 1, name: "Crochet Rose Bouquet", price: 299, cat: "flowers", img: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=300&fit=crop"},
        {id: 2, name: "Sunflower Collection", price: 349, cat: "flowers", img: "https://images.unsplash.com/photo-1586201375761-83865001e31c?w=300&h=300&fit=crop"},
        {id: 3, name: "Crochet Teddy Bear", price: 899, cat: "toys", img: "https://images.unsplash.com/photo-1594787318287-7c5cee6dce76?w=300&h=300&fit=crop"},
        {id: 4, name: "Elegant Handbag", price: 1499, cat: "accessories", img: "https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=300&h=300&fit=crop"},
        {id: 5, name: "Baby Booties Set", price: 499, cat: "baby", img: "https://images.unsplash.com/photo-1539185441755-769473a23570?w=300&h=300&fit=crop"},
        {id: 6, name: "Custom Crochet Order", price: "As per design", cat: "custom", img: "https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=300&h=300&fit=crop"},
        {id: 7, name: "Money Bouquet", price: 1999, cat: "money", img: "https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?w=300&h=300&fit=crop"}
    ];
    
    localStorage.setItem('kallakritiProducts', JSON.stringify(items));
}

// ==================== CUSTOMER LOGIN SYSTEM ====================
let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
let customers = JSON.parse(localStorage.getItem('kallakritiCustomers') || '[]');
let isLoginMode = true; // true for login, false for signup

// Initialize user
function initUser() {
    if (currentUser) {
        // Load user's cart
        loadUserCart();
        
        // Update UI
        document.getElementById('userBtnText').textContent = 'Logout';
        document.getElementById('userName').textContent = currentUser.name;
        document.getElementById('userName').style.display = 'inline';
    } else {
        document.getElementById('userBtnText').textContent = 'Login';
        document.getElementById('userName').style.display = 'none';
    }
}

// Handle login/signup
function handleLogin(event) {
    event.preventDefault();
    
    const phone = document.getElementById('loginPhone').value.trim();
    const password = document.getElementById('loginPassword').value.trim();
    
    if (isLoginMode) {
        // LOGIN
        const user = customers.find(c => c.phone === phone && c.password === password);
        
        if (user) {
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Load user's cart
            loadUserCart();
            
            alert(`Welcome back, ${user.name}!`);
            closeLogin();
            initUser();
            updateCartCount();
        } else {
            alert('Invalid phone number or password!');
        }
    } else {
        // SIGNUP
        const name = document.getElementById('signupName').value.trim();
        
        if (!name || !phone || !password) {
            alert('Please fill all fields!');
            return;
        }
        
        // Check if user already exists
        if (customers.find(c => c.phone === phone)) {
            alert('Phone number already registered! Please login instead.');
            toggleLoginMode();
            return;
        }
        
        const newUser = {
            id: Date.now(),
            name: name,
            phone: phone,
            password: password,
            joinDate: new Date().toISOString(),
            cart: []
        };
        
        customers.push(newUser);
        localStorage.setItem('kallakritiCustomers', JSON.stringify(customers));
        
        currentUser = newUser;
        localStorage.setItem('currentUser', JSON.stringify(newUser));
        
        alert(`Welcome to Kallakriti, ${name}! Your account has been created.`);
        closeLogin();
        initUser();
    }
    
    // Clear form
    document.getElementById('loginForm').reset();
}

// Toggle between login and signup
function toggleLoginMode() {
    isLoginMode = !isLoginMode;
    
    const signupFields = document.getElementById('signupFields');
    const loginTitle = document.getElementById('loginTitle');
    const loginSubmitText = document.getElementById('loginSubmitText');
    const loginSwitchText = document.getElementById('loginSwitchText');
    const loginSwitchLink = document.getElementById('loginSwitchLink');
    
    if (isLoginMode) {
        // Switch to login
        signupFields.style.display = 'none';
        loginTitle.textContent = 'Customer Login';
        loginSubmitText.textContent = 'Login';
        loginSwitchText.textContent = 'New customer?';
        loginSwitchLink.textContent = 'Sign Up';
    } else {
        // Switch to signup
        signupFields.style.display = 'block';
        loginTitle.textContent = 'Create Account';
        loginSubmitText.textContent = 'Sign Up';
        loginSwitchText.textContent = 'Already have an account?';
        loginSwitchLink.textContent = 'Login';
    }
}

// Load user's cart
function loadUserCart() {
    if (currentUser) {
        const user = customers.find(c => c.id === currentUser.id);
        if (user && user.cart) {
            cart = JSON.parse(JSON.stringify(user.cart)); // Deep copy
            localStorage.setItem('kallakritiCart', JSON.stringify(cart));
        }
    }
}

// Save user's cart
function saveUserCart() {
    if (currentUser) {
        const userIndex = customers.findIndex(c => c.id === currentUser.id);
        if (userIndex !== -1) {
            // Deep copy to avoid reference issues
            customers[userIndex].cart = JSON.parse(JSON.stringify(cart));
            localStorage.setItem('kallakritiCustomers', JSON.stringify(customers));
            localStorage.setItem('currentUser', JSON.stringify(customers[userIndex]));
            currentUser = customers[userIndex];
        }
    }
}

// Logout
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        // Save cart before logout
        saveUserCart();
        
        currentUser = null;
        localStorage.removeItem('currentUser');
        
        // Clear cart for guest
        cart = [];
        localStorage.setItem('kallakritiCart', JSON.stringify(cart));
        
        initUser();
        updateCartCount();
        updateCartDisplay();
        
        alert('Logged out successfully!');
    }
}

// Open login modal
function openLogin() {
    if (currentUser) {
        logout();
    } else {
        document.getElementById('loginModal').style.display = 'flex';
        document.getElementById('loginPhone').focus();
    }
}

function closeLogin() {
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('loginForm').reset();
}

// ==================== CART SYSTEM - FIXED FOR MULTIPLE ITEMS ====================
let cart = JSON.parse(localStorage.getItem('kallakritiCart') || '[]');

function addToCart(id, name, price, image) {
    if (!currentUser) {
        alert('Please login first to add items to cart!');
        openLogin();
        return;
    }
    
    // Check if item already exists in cart
    const existingItemIndex = cart.findIndex(item => item.id === id);
    
    if (existingItemIndex !== -1) {
        // Item exists, increase quantity
        cart[existingItemIndex].quantity += 1;
    } else {
        // Item doesn't exist, add new item
        cart.push({
            id: id,
            name: name,
            price: price,
            image: image,
            quantity: 1
        });
    }
    
    saveCart();
    updateCartCount();
    showCartNotification(name);
}

function updateQuantity(id, change) {
    const itemIndex = cart.findIndex(item => item.id === id);
    
    if (itemIndex !== -1) {
        cart[itemIndex].quantity += change;
        
        if (cart[itemIndex].quantity <= 0) {
            cart.splice(itemIndex, 1);
        }
        
        saveCart();
        updateCartCount();
        updateCartDisplay();
    }
}

function removeFromCart(id) {
    const itemIndex = cart.findIndex(item => item.id === id);
    if (itemIndex !== -1) {
        cart.splice(itemIndex, 1);
        saveCart();
        updateCartCount();
        updateCartDisplay();
    }
}

function saveCart() {
    localStorage.setItem('kallakritiCart', JSON.stringify(cart));
    saveUserCart(); // Also save to user's account
}

function updateCartCount() {
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    document.getElementById('cartCount').textContent = totalItems;
}

function openCart() {
    if (!currentUser && cart.length > 0) {
        if (confirm('Please login to save your cart. Login now?')) {
            openLogin();
            return;
        }
    }
    
    document.getElementById('cartModal').style.display = 'flex';
    updateCartDisplay();
}

function closeCart() {
    document.getElementById('cartModal').style.display = 'none';
}

function updateCartDisplay() {
    const cartItems = document.getElementById('cartItems');
    const cartTotal = document.getElementById('cartTotal');
    
    if (cart.length === 0) {
        cartItems.innerHTML = `
            <div class="cart-empty">
                <i class="fas fa-shopping-cart" style="font-size: 50px; color: #ccc; margin-bottom: 20px;"></i>
                <p>Your cart is empty</p>
                <p style="font-size: 0.9rem; color: #999;">Add some products to get started!</p>
            </div>
        `;
        cartTotal.textContent = '₹0';
        return;
    }
    
    let total = 0;
    cartItems.innerHTML = '';
    
    cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        cartItem.innerHTML = `
            <img src="${item.image}" alt="${item.name}" class="cart-item-img">
            <div class="cart-item-details">
                <div class="cart-item-name">${item.name}</div>
                <div class="cart-item-price">₹${item.price} × ${item.quantity} = ₹${itemTotal}</div>
                <div class="cart-item-controls">
                    <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                    <span class="cart-item-quantity">${item.quantity}</span>
                    <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                </div>
            </div>
            <button class="cart-item-remove" onclick="removeFromCart(${item.id})">
                <i class="fas fa-times"></i>
            </button>
        `;
        cartItems.appendChild(cartItem);
    });
    
    cartTotal.textContent = `₹${total}`;
}

function clearCart() {
    if (cart.length === 0) return;
    
    if (confirm('Are you sure you want to clear your cart?')) {
        cart = [];
        saveCart();
        updateCartCount();
        updateCartDisplay();
    }
}

function checkout() {
    if (cart.length === 0) {
        alert('Your cart is empty! Add some products first.');
        return;
    }
    
    if (!currentUser) {
        alert('Please login to checkout!');
        openLogin();
        return;
    }
    
    let message = `Hello Kallakriti! I want to order:\n\n`;
    message += `Customer: ${currentUser.name}\n`;
    message += `Phone: ${currentUser.phone}\n\n`;
    message += `Order Items:\n`;
    
    let total = 0;
    cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        message += `${index + 1}. ${item.name} (Qty: ${item.quantity}) - ₹${itemTotal}\n`;
    });
    
    message += `\nTotal: ₹${total}\n\n`;
    message += `Please confirm my order and share payment details.`;
    
    window.open(`https://wa.me/${phone}?text=${encodeURIComponent(message)}`, '_blank');
}

function showCartNotification(productName) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        background: #2ecc71;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideIn 0.3s ease;
    `;
    
    notification.innerHTML = `
        <i class="fas fa-check-circle"></i>
        <span>${productName} added to cart!</span>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

// Add CSS for animations
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);

// ==================== PRODUCT DISPLAY ====================
const logoUrl = "https://raw.githubusercontent.com/kallakriti/kallakriti/main/images/logo.png";
let currentCategory = "all";
let dropdownOpen = false;

function showFallbackLogo(imgElement) {
    imgElement.src = "https://cdn-icons-png.flaticon.com/512/3095/3095112.png";
    imgElement.style.backgroundColor = "#9c7c38";
    imgElement.style.padding = "8px";
    imgElement.alt = "Kallakriti - Handmade Crafts";
}

function toggleCategoryDropdown(event) {
    event.stopPropagation();
    const dropdown = document.getElementById('categoryDropdown');
    dropdownOpen = !dropdownOpen;
    dropdown.classList.toggle('show');
    updateActiveButtons();
}

function selectCategory(cat) {
    currentCategory = cat;
    displayProducts();
    dropdownOpen = false;
    document.getElementById('categoryDropdown').classList.remove('show');
    
    const categoryNames = {
        'all': 'All Products',
        'flowers': 'Crochet Flowers',
        'toys': 'Crochet Toys',
        'accessories': 'Accessories',
        'baby': 'Baby Items',
        'custom': 'Custom Orders',
        'money': 'Money Bouquets'
    };
    document.getElementById('currentCategoryText').textContent = `☰ ${categoryNames[cat]}`;
    updateActiveButtons();
}

function updateActiveButtons() {
    const buttons = document.querySelectorAll('.category-dropdown button');
    buttons.forEach(button => {
        const onclickAttr = button.getAttribute('onclick');
        if (onclickAttr) {
            const category = onclickAttr.match(/'(\w+)'/)[1];
            if (category === currentCategory) {
                button.classList.add('active');
            } else {
                button.classList.remove('active');
            }
        }
    });
}

function displayProducts() {
    const box = document.getElementById("products");
    box.innerHTML = "";
    
    const filteredItems = currentCategory === "all" 
        ? items 
        : items.filter(item => item.cat === currentCategory);
    
    filteredItems.forEach(item => {
        const escapedName = item.name.replace(/'/g, "\\'");
        box.innerHTML += `
        <div class="card">
            <img src="${item.img}" alt="${item.name}" 
                 onerror="this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=300&h=300&fit=crop&crop=center'">
            <h3>${item.name}</h3>
            <div class="price">${typeof item.price === 'number' ? '₹' + item.price : item.price}</div>
            ${typeof item.price === 'number' ? `
            <button class="cart-add-btn" onclick="addToCart(${item.id}, '${escapedName}', ${item.price}, '${item.img}')">
                <i class="fas fa-cart-plus"></i> Add to Cart
            </button>
            ` : ''}
            <button class="order-btn" onclick="orderProduct('${escapedName}')">
                <i class="fab fa-whatsapp"></i> Order Now
            </button>
        </div>`;
    });
}

function orderProduct(productName){
    const message = `Hello Kallakriti! I'm interested in ordering: ${productName}`;
    window.open(`https://wa.me/${phone}?text=${encodeURIComponent(message)}`, '_blank');
}

// ==================== COMPLAINT SYSTEM ====================
function openComplaintModal() {
    document.getElementById('complaintModal').style.display = 'flex';
}

function closeComplaintModal() {
    document.getElementById('complaintModal').style.display = 'none';
    document.getElementById('complaintForm').reset();
}

function submitComplaint(event) {
    event.preventDefault();
    
    const complaint = {
        name: document.getElementById('complaintName').value,
        email: document.getElementById('complaintEmail').value,
        phone: document.getElementById('complaintPhone').value,
        type: document.getElementById('complaintType').value,
        details: document.getElementById('complaintDetails').value,
        date: new Date().toLocaleString(),
        id: 'COMP-' + Date.now()
    };
    
    let complaints = JSON.parse(localStorage.getItem('kallakritiComplaints') || '[]');
    complaints.push(complaint);
    localStorage.setItem('kallakritiComplaints', JSON.stringify(complaints));
    
    alert('✅ Complaint registered successfully! We will contact you within 24 hours.');
    closeComplaintModal();
}

// ==================== EVENT LISTENERS ====================
document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('categoryDropdown');
    const categoryBtn = document.querySelector('.category-btn');
    
    if (dropdownOpen && !dropdown.contains(event.target) && !categoryBtn.contains(event.target)) {
        dropdownOpen = false;
        dropdown.classList.remove('show');
    }
});

window.addEventListener('click', function(event) {
    const cartModal = document.getElementById('cartModal');
    const complaintModal = document.getElementById('complaintModal');
    const loginModal = document.getElementById('loginModal');
    
    if (event.target === cartModal) closeCart();
    if (event.target === complaintModal) closeComplaintModal();
    if (event.target === loginModal) closeLogin();
});

// ==================== INITIALIZATION ====================
window.addEventListener('load', function() {
    // Initialize user
    initUser();
    
    // Display products
    displayProducts();
    updateActiveButtons();
    updateCartCount();
    
    // Check logo
    const logoImg = document.querySelector('.logo-img');
    if (logoImg) {
        const testLogo = new Image();
        testLogo.src = logoUrl;
        testLogo.onerror = function() {
            showFallbackLogo(logoImg);
        };
    }
    
    // Check for settings updates
    setInterval(() => {
        const newSettings = JSON.parse(localStorage.getItem('kallakritiSettings') || JSON.stringify(defaultSettings));
        if (newSettings.whatsappNumber !== settings.whatsappNumber) {
            settings = newSettings;
            phone = settings.whatsappNumber;
            whatsappLink.href = `https://wa.me/${phone}?text=Hello Kallakriti, I have an inquiry`;
            document.getElementById('footerPhone').textContent = `+91 ${phone}`;
            document.getElementById('footerEmail').textContent = settings.adminEmail;
        }
    }, 5000);
});
</script>
</body>
</html>
